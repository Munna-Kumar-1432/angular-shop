<div class="min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-7xl mx-auto">
    <h1 class="text-4xl font-extrabold text-gray-900 text-center mb-10">Secure Checkout</h1>

    <div class="lg:grid lg:grid-cols-3 lg:gap-10">
      <!-- Checkout Form Section -->
      <div class="lg:col-span-2 bg-white rounded-xl shadow-lg p-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Shipping & Payment</h2>
        <form [formGroup]="checkoutForm" (ngSubmit)="onSubmit()" class="space-y-8">

          <!-- Personal Information -->
          <div class="border-b border-gray-200 pb-8">
            <h3 class="text-xl font-semibold text-gray-700 mb-4">Personal Information</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="firstName" class="block text-sm font-medium text-gray-700">First Name</label>
                <input id="firstName" type="text" formControlName="firstName" 
                       class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                       [class.border-red-500]="checkoutForm.get('firstName')?.invalid && checkoutForm.get('firstName')?.touched">
                <div *ngIf="checkoutForm.get('firstName')?.errors?.['required'] && checkoutForm.get('firstName')?.touched" class="text-red-500 text-xs mt-1">
                  First name is required.
                </div>
              </div>
              <div>
                <label for="lastName" class="block text-sm font-medium text-gray-700">Last Name</label>
                <input id="lastName" type="text" formControlName="lastName" 
                       class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                       [class.border-red-500]="checkoutForm.get('lastName')?.invalid && checkoutForm.get('lastName')?.touched">
                <div *ngIf="checkoutForm.get('lastName')?.errors?.['required'] && checkoutForm.get('lastName')?.touched" class="text-red-500 text-xs mt-1">
                  Last name is required.
                </div>
              </div>
              <div>
                <label for="email" class="block text-sm font-medium text-gray-700">Email Address</label>
                <input id="email" type="email" formControlName="email" 
                       class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                       [class.border-red-500]="checkoutForm.get('email')?.invalid && checkoutForm.get('email')?.touched">
                <div *ngIf="checkoutForm.get('email')?.errors?.['required'] && checkoutForm.get('email')?.touched" class="text-red-500 text-xs mt-1">
                  Email is required.
                </div>
                <div *ngIf="checkoutForm.get('email')?.errors?.['email'] && checkoutForm.get('email')?.touched" class="text-red-500 text-xs mt-1">
                  Please enter a valid email address.
                </div>
              </div>
              <div>
                <label for="phone" class="block text-sm font-medium text-gray-700">Phone Number</label>
                <input id="phone" type="tel" formControlName="phone" 
                       class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                       [class.border-red-500]="checkoutForm.get('phone')?.invalid && checkoutForm.get('phone')?.touched">
                <div *ngIf="checkoutForm.get('phone')?.errors?.['required'] && checkoutForm.get('phone')?.touched" class="text-red-500 text-xs mt-1">
                  Phone number is required.
                </div>
              </div>
            </div>
          </div>

          <!-- Shipping Address -->
          <div class="border-b border-gray-200 pb-8">
            <h3 class="text-xl font-semibold text-gray-700 mb-4">Shipping Address</h3>
            <div class="space-y-6">
              <div>
                <label for="address" class="block text-sm font-medium text-gray-700">Address Line 1</label>
                <input id="address" type="text" formControlName="address" 
                       class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                       [class.border-red-500]="checkoutForm.get('address')?.invalid && checkoutForm.get('address')?.touched">
                <div *ngIf="checkoutForm.get('address')?.errors?.['required'] && checkoutForm.get('address')?.touched" class="text-red-500 text-xs mt-1">
                  Address is required.
                </div>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                  <label for="city" class="block text-sm font-medium text-gray-700">City</label>
                  <input id="city" type="text" formControlName="city" 
                         class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                         [class.border-red-500]="checkoutForm.get('city')?.invalid && checkoutForm.get('city')?.touched">
                  <div *ngIf="checkoutForm.get('city')?.errors?.['required'] && checkoutForm.get('city')?.touched" class="text-red-500 text-xs mt-1">
                    City is required.
                  </div>
                </div>
                <div>
                  <label for="state" class="block text-sm font-medium text-gray-700">State / Province</label>
                  <input id="state" type="text" formControlName="state" 
                         class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                         [class.border-red-500]="checkoutForm.get('state')?.invalid && checkoutForm.get('state')?.touched">
                  <div *ngIf="checkoutForm.get('state')?.errors?.['required'] && checkoutForm.get('state')?.touched" class="text-red-500 text-xs mt-1">
                    State is required.
                  </div>
                </div>
                <div>
                  <label for="zipCode" class="block text-sm font-medium text-gray-700">ZIP / Postal Code</label>
                  <input id="zipCode" type="text" formControlName="zipCode" 
                         class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                         [class.border-red-500]="checkoutForm.get('zipCode')?.invalid && checkoutForm.get('zipCode')?.touched">
                  <div *ngIf="checkoutForm.get('zipCode')?.errors?.['required'] && checkoutForm.get('zipCode')?.touched" class="text-red-500 text-xs mt-1">
                    ZIP Code is required.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Payment Information -->
          <div>
            <h3 class="text-xl font-semibold text-gray-700 mb-4">Payment Information</h3>
            <div class="space-y-6">
              <div>
                <label for="cardNumber" class="block text-sm font-medium text-gray-700">Card Number</label>
                <input id="cardNumber" type="text" formControlName="cardNumber" 
                       class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                       [class.border-red-500]="checkoutForm.get('cardNumber')?.invalid && checkoutForm.get('cardNumber')?.touched">
                <div *ngIf="checkoutForm.get('cardNumber')?.errors?.['required'] && checkoutForm.get('cardNumber')?.touched" class="text-red-500 text-xs mt-1">
                  Card number is required.
                </div>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label for="expiryDate" class="block text-sm font-medium text-gray-700">Expiry Date</label>
                  <input id="expiryDate" type="text" formControlName="expiryDate" placeholder="MM/YY" 
                         class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                         [class.border-red-500]="checkoutForm.get('expiryDate')?.invalid && checkoutForm.get('expiryDate')?.touched">
                  <div *ngIf="checkoutForm.get('expiryDate')?.errors?.['required'] && checkoutForm.get('expiryDate')?.touched" class="text-red-500 text-xs mt-1">
                    Expiry date is required.
                  </div>
                </div>
                <div>
                  <label for="cvv" class="block text-sm font-medium text-gray-700">CVV</label>
                  <input id="cvv" type="text" formControlName="cvv" 
                         class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"
                         [class.border-red-500]="checkoutForm.get('cvv')?.invalid && checkoutForm.get('cvv')?.touched">
                  <div *ngIf="checkoutForm.get('cvv')?.errors?.['required'] && checkoutForm.get('cvv')?.touched" class="text-red-500 text-xs mt-1">
                    CVV is required.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <button type="submit" [disabled]="checkoutForm.invalid || isSubmitting" 
                  class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-lg font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition duration-150 ease-in-out">
            {{ isSubmitting ? 'Processing Order...' : 'Place Order' }}
          </button>
        </form>
      </div>

      <!-- Order Summary Section -->
      <div class="lg:col-span-1 mt-10 lg:mt-0">
        <div class="bg-white rounded-xl shadow-lg p-8 sticky top-28">
          <h2 class="text-2xl font-bold text-gray-800 mb-6">Order Summary</h2>
          <div class="space-y-4">
            <div *ngFor="let item of cartItems" class="flex items-start space-x-4 border-b border-gray-200 pb-4 last:border-b-0 last:pb-0">
              <img [src]="item.product.thumbnail" [alt]="item.product.title" class="w-20 h-20 object-cover rounded-lg shadow-sm">
              <div class="flex-1">
                <h3 class="text-lg font-semibold text-gray-900">{{ item.product.title }}</h3>
                <p class="text-sm text-gray-600">Quantity: {{ item.quantity }}</p>
                <p class="text-md font-bold text-indigo-600">${{ (item.product.price * (1 - item.product.discountPercentage / 100) * item.quantity).toFixed(2) }}</p>
              </div>
            </div>
            <div class="border-t border-gray-200 pt-6 space-y-3 mt-6">
              <div class="flex justify-between text-gray-800">
                <span class="font-medium">Subtotal:</span>
                <span class="font-bold">${{ subtotal.toFixed(2) }}</span>
              </div>
              <div class="flex justify-between text-gray-800">
                <span class="font-medium">Shipping:</span>
                <span class="font-bold">${{ shipping.toFixed(2) }}</span>
              </div>
              <div class="flex justify-between text-gray-800 text-xl font-extrabold border-t border-gray-300 pt-4 mt-4">
                <span>Order Total:</span>
                <span>${{ total.toFixed(2) }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 